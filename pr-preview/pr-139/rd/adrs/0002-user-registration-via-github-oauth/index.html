<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/battlebots/pr-preview/pr-139/favicons/favicon.ico><link rel=apple-touch-icon href=/battlebots/pr-preview/pr-139/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/battlebots/pr-preview/pr-139/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/battlebots/pr-preview/pr-139/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/battlebots/pr-preview/pr-139/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/battlebots/pr-preview/pr-139/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/battlebots/pr-preview/pr-139/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/battlebots/pr-preview/pr-139/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/battlebots/pr-preview/pr-139/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/battlebots/pr-preview/pr-139/favicons/android-192x192.png sizes=192x192><title>[0002] User Registration via GitHub OAuth | Battle Bots Documentation</title><meta name=description content="How users will register and authenticate with the Battle Bots platform using GitHub OAuth and stateless JWT tokens"><meta property="og:url" content="https://z5labs.github.io/battlebots/pr-preview/pr-139/rd/adrs/0002-user-registration-via-github-oauth/"><meta property="og:site_name" content="Battle Bots Documentation"><meta property="og:title" content="[0002] User Registration via GitHub OAuth"><meta property="og:description" content="How users will register and authenticate with the Battle Bots platform using GitHub OAuth and stateless JWT tokens"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="r&amp;d"><meta property="article:published_time" content="2025-11-02T00:00:00+00:00"><meta property="article:modified_time" content="2025-11-02T00:00:00+00:00"><meta itemprop=name content="[0002] User Registration via GitHub OAuth"><meta itemprop=description content="How users will register and authenticate with the Battle Bots platform using GitHub OAuth and stateless JWT tokens"><meta itemprop=datePublished content="2025-11-02T00:00:00+00:00"><meta itemprop=dateModified content="2025-11-02T00:00:00+00:00"><meta itemprop=wordCount content="4259"><meta name=twitter:card content="summary"><meta name=twitter:title content="[0002] User Registration via GitHub OAuth"><meta name=twitter:description content="How users will register and authenticate with the Battle Bots platform using GitHub OAuth and stateless JWT tokens"><link rel=preload href=/battlebots/pr-preview/pr-139/scss/main.min.74eef40c5172b0e2f11bd9c3ea40dba66c2dc642ac5294c208f5dc9ff772c0e9.css as=style integrity="sha256-dO70DFFysOLxG9nD6kDbpmwtxkKsUpTCCPXcn/dywOk=" crossorigin=anonymous><link href=/battlebots/pr-preview/pr-139/scss/main.min.74eef40c5172b0e2f11bd9c3ea40dba66c2dc642ac5294c208f5dc9ff772c0e9.css rel=stylesheet integrity="sha256-dO70DFFysOLxG9nD6kDbpmwtxkKsUpTCCPXcn/dywOk=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-page><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/battlebots/pr-preview/pr-139/><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class=navbar-brand__name>Battle Bots Documentation</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav></ul></div><div class="d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/battlebots/pr-preview/pr-139/offline-search-index.e81ec1f6b1c2c5d7ef0fe710de9dd541.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/battlebots/pr-preview/pr-139/offline-search-index.e81ec1f6b1c2c5d7ef0fe710de9dd541.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="td-sidebar-nav collapse" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-battlebotspr-previewpr-139-li><a href=/battlebots/pr-preview/pr-139/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-battlebotspr-previewpr-139><span>Battle Bots</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-battlebotspr-previewpr-139rd-li><a href=/battlebots/pr-preview/pr-139/rd/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-battlebotspr-previewpr-139rd><span>Research & Design</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-battlebotspr-previewpr-139rduser-journeys-li><a href=/battlebots/pr-preview/pr-139/rd/user-journeys/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-battlebotspr-previewpr-139rduser-journeys><span>User Journeys</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-battlebotspr-previewpr-139rduser-journeys0001-user-registration-li><a href=/battlebots/pr-preview/pr-139/rd/user-journeys/0001-user-registration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-battlebotspr-previewpr-139rduser-journeys0001-user-registration><span>[0001] User Registration</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-battlebotspr-previewpr-139rdadrs-li><a href=/battlebots/pr-preview/pr-139/rd/adrs/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-battlebotspr-previewpr-139rdadrs><span>Architecture Decision Records</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-battlebotspr-previewpr-139rdadrs0001-use-madr-for-architecture-decision-records-li><a href=/battlebots/pr-preview/pr-139/rd/adrs/0001-use-madr-for-architecture-decision-records/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-battlebotspr-previewpr-139rdadrs0001-use-madr-for-architecture-decision-records><span>[0001] Use MADR for Architecture Decision Records</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-battlebotspr-previewpr-139rdadrs0002-user-registration-via-github-oauth-li><a href=/battlebots/pr-preview/pr-139/rd/adrs/0002-user-registration-via-github-oauth/ class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-battlebotspr-previewpr-139rdadrs0002-user-registration-via-github-oauth><span class=td-sidebar-nav-active-item>[0002] User Registration via GitHub OAuth</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-battlebotspr-previewpr-139rdadrs0003-stateless-jwt-authentication-li><a href=/battlebots/pr-preview/pr-139/rd/adrs/0003-stateless-jwt-authentication/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-battlebotspr-previewpr-139rdadrs0003-stateless-jwt-authentication><span>[0003] Stateless Authentication via JWT Tokens</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-battlebotspr-previewpr-139rdanalysis-li><a href=/battlebots/pr-preview/pr-139/rd/analysis/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-battlebotspr-previewpr-139rdanalysis><span>Analysis</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id=m-battlebotspr-previewpr-139rdanalysisopen-source-applications-li><a href=/battlebots/pr-preview/pr-139/rd/analysis/open-source-applications/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-battlebotspr-previewpr-139rdanalysisopen-source-applications><span>Open Source Applications</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-battlebotspr-previewpr-139rdanalysisopen-source-applicationsopenfga-analysis-li><a href=/battlebots/pr-preview/pr-139/rd/analysis/open-source-applications/openfga-analysis/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-battlebotspr-previewpr-139rdanalysisopen-source-applicationsopenfga-analysis><span>OpenFGA Analysis</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child collapse" id=m-battlebotspr-previewpr-139rdanalysissecurity-li><a href=/battlebots/pr-preview/pr-139/rd/analysis/security/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-battlebotspr-previewpr-139rdanalysissecurity><span>Security</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-battlebotspr-previewpr-139rdanalysissecurityauth0-login-pages-analysis-li><a href=/battlebots/pr-preview/pr-139/rd/analysis/security/auth0-login-pages-analysis/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-battlebotspr-previewpr-139rdanalysissecurityauth0-login-pages-analysis><span>Auth0 Login Pages Analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-battlebotspr-previewpr-139rdanalysissecuritykeycloak-login-pages-analysis-li><a href=/battlebots/pr-preview/pr-139/rd/analysis/security/keycloak-login-pages-analysis/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-battlebotspr-previewpr-139rdanalysissecuritykeycloak-login-pages-analysis><span>Keycloak Login Pages Analysis</span></a></li></ul></li></ul></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"><a href=https://github.com/z5labs/battlebots/tree/main/content/r&amp;d/adrs/0002-user-registration-via-github-oauth.md class="td-page-meta--view td-page-meta__view" target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a href=https://github.com/z5labs/battlebots/edit/main/content/r&amp;d/adrs/0002-user-registration-via-github-oauth.md class="td-page-meta--edit td-page-meta__edit" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a href="https://github.com/z5labs/battlebots/new/main/content/r&amp;d/adrs?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class="td-page-meta--child td-page-meta__child" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/z5labs/battlebots/issues/new?title=[0002]%20User%20Registration%20via%20GitHub%20OAuth" class="td-page-meta--issue td-page-meta__issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/z5labs/battlebots/issues/new class="td-page-meta--project td-page-meta__project-issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create project issue</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#context-and-problem-statement>Context and Problem Statement</a></li><li><a href=#decision-drivers>Decision Drivers</a></li><li><a href=#considered-options>Considered Options</a></li><li><a href=#decision-outcome>Decision Outcome</a><ul><li><a href=#consequences>Consequences</a></li><li><a href=#confirmation>Confirmation</a></li></ul></li><li><a href=#pros-and-cons-of-the-options>Pros and Cons of the Options</a><ul><li><a href=#github-oauth-authentication-with-openfga-authorization>GitHub OAuth authentication with OpenFGA authorization</a></li><li><a href=#emailpassword-registration-with-jwt>Email/password registration with JWT</a></li><li><a href=#google-oauth-authentication>Google OAuth authentication</a></li><li><a href=#support-multiple-oauth-providers-github-google-gitlab>Support multiple OAuth providers (GitHub, Google, GitLab)</a></li></ul></li><li><a href=#more-information>More Information</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/battlebots/pr-preview/pr-139/rd/>Research & Design</a></li><li class=breadcrumb-item><a href=/battlebots/pr-preview/pr-139/rd/adrs/>Architecture Decision Records</a></li><li class="breadcrumb-item active" aria-current=page>[0002] User Registration via GitHub OAuth</li></ol></nav><div class=td-content><h1>[0002] User Registration via GitHub OAuth</h1><div class=lead>How users will register and authenticate with the Battle Bots platform using GitHub OAuth and stateless JWT tokens</div><header class=article-meta></header><h2 id=context-and-problem-statement>Context and Problem Statement</h2><p>Users need a way to register and authenticate with the Battle Bots platform to create and manage their autonomous bots. The registration process should be secure, user-friendly, and minimize friction for developers who are our target audience.</p><p>How should we implement user registration and authentication for the Battle Bots platform?</p><h2 id=decision-drivers>Decision Drivers</h2><ul><li>User experience: Minimize registration friction for developer audience</li><li>Security: Ensure secure authentication without managing passwords</li><li>Implementation complexity: Reduce development and maintenance burden</li><li>Timeline: Need to launch quickly with minimal authentication infrastructure</li><li>Trust: Leverage existing identity providers that developers already use</li><li>Bot deployment: Need to tie bot ownership to verified user accounts</li></ul><h2 id=considered-options>Considered Options</h2><ul><li>GitHub OAuth authentication</li><li>Email/password registration with JWT</li><li>Google OAuth authentication</li><li>Support multiple OAuth providers (GitHub, Google, GitLab)</li></ul><h2 id=decision-outcome>Decision Outcome</h2><p>Chosen option: &ldquo;GitHub OAuth authentication with stateless JWT tokens&rdquo;, because it best meets our decision drivers:</p><ul><li><strong>User experience</strong>: Developers already have GitHub accounts - minimal registration friction</li><li><strong>Security</strong>: Leverages GitHub&rsquo;s OAuth 2.0 without password management burden</li><li><strong>Implementation complexity</strong>: Single OAuth provider reduces development time</li><li><strong>Timeline</strong>: Fastest path to launch with proven technology</li><li><strong>Trust</strong>: GitHub is the natural identity provider for our developer audience</li><li><strong>Scalability</strong>: Stateless JWT tokens enable horizontal scaling without session synchronization</li></ul><p>The implementation uses GitHub OAuth for initial authentication, then converts the GitHub access token to internal JWT tokens for stateless API authentication. This hybrid approach provides OAuth convenience with JWT scalability.</p><h3 id=consequences>Consequences</h3><ul><li>Good, because no server-side session state enables horizontal scalability</li><li>Good, because JWT tokens reduce database lookups (user info in token claims)</li><li>Good, because stateless architecture simplifies microservices integration</li><li>Good, because developers trust GitHub as identity provider</li><li>Good, because refresh token rotation provides security without UX friction</li><li>Neutral, because requires implementing JWT token service (RS256 signing/validation)</li><li>Neutral, because GitHub OAuth is OAuth 2.0, not OIDC (must generate our own ID tokens)</li><li>Bad, because vendor dependency on GitHub for initial authentication</li><li>Bad, because requires token blacklist for immediate revocation (adds some state)</li><li>Bad, because limits to users with GitHub accounts (acceptable for developer audience)</li></ul><h3 id=confirmation>Confirmation</h3><p>Implementation compliance will be confirmed through:</p><ol><li><strong>Security Testing</strong>: Penetration testing validates XSS/CSRF protection, token validation, and PKCE implementation</li><li><strong>Integration Tests</strong>: Automated tests verify complete OAuth flow and JWT token generation/validation</li><li><strong>Code Review</strong>: Security-focused review of JWT signing, token storage, and refresh token rotation</li><li><strong>Load Testing</strong>: Horizontal scalability validated with 10,000+ concurrent users across multiple servers</li><li><strong>Documentation Review</strong>: Architecture diagrams and sequence diagrams accurately reflect stateless JWT implementation</li></ol><h2 id=pros-and-cons-of-the-options>Pros and Cons of the Options</h2><h3 id=github-oauth-authentication-with-openfga-authorization>GitHub OAuth authentication with OpenFGA authorization</h3><p>Single OAuth provider (GitHub) for registration and authentication, combined with OpenFGA for fine-grained authorization.</p><p><strong>Authentication vs Authorization:</strong></p><ul><li><strong>Authentication (GitHub OAuth + JWT):</strong> Verifies user identity - &ldquo;Who are you?&rdquo;</li><li><strong>Authorization (OpenFGA):</strong> Determines permissions - &ldquo;What can you do?&rdquo;</li></ul><p>This option separates authentication concerns (handled by GitHub OAuth and JWT tokens) from authorization concerns (handled by OpenFGA). Users authenticate once via GitHub, receive JWT tokens for API access, and every protected operation checks permissions through OpenFGA based on relationships between users and resources (organizations, teams, bots, games).</p><ul><li>Good, because target audience (developers) already have GitHub accounts</li><li>Good, because no password management or reset flows needed</li><li>Good, because GitHub&rsquo;s OAuth is well-documented and reliable</li><li>Good, because reduces implementation complexity and time to launch</li><li>Good, because GitHub identity ties naturally to developer workflows</li><li>Good, because OpenFGA provides fine-grained authorization (object-level permissions, not just roles)</li><li>Good, because OpenFGA naturally models organizational hierarchy (organization → team → bot → game)</li><li>Good, because OpenFGA scales to millions of authorization relationships and checks</li><li>Good, because separation of authentication (GitHub OAuth) and authorization (OpenFGA) follows security best practices</li><li>Good, because self-hosted OpenFGA has no per-user costs (important for platform growth)</li><li>Good, because OpenFGA&rsquo;s ReBAC model supports complex permission inheritance and delegation</li><li>Neutral, because limits to users with GitHub accounts (acceptable for developer audience)</li><li>Neutral, because requires deploying and maintaining OpenFGA service infrastructure</li><li>Neutral, because requires learning ReBAC authorization modeling concepts</li><li>Bad, because vendor dependency on GitHub for authentication</li><li>Bad, because no fallback if GitHub OAuth is unavailable</li><li>Bad, because additional infrastructure complexity (OpenFGA service + database for authorization data)</li><li>Bad, because network latency added for OpenFGA authorization checks on every protected operation</li></ul><h4 id=implementation-visualization>Implementation Visualization</h4><p><strong>Architecture Diagram:</strong></p><pre class=mermaid>graph LR
    User[User Browser] --&gt; WebApp[Battle Bots Web App]
    WebApp --&gt; GitHub[GitHub OAuth]
    WebApp --&gt; DB[(Application Database)]
    WebApp --&gt; AuthSvc[Auth Service&lt;br/&gt;&#43; JWKS Endpoint]
    WebApp --&gt; Redis[(Redis - Token Blacklist)]
    WebApp --&gt; AuthZ[OpenFGA Service]
    AuthZ --&gt; FGA_DB[(OpenFGA Database)]
    GitHub --&gt; User

    style WebApp fill:#e1f5ff
    style GitHub fill:#f0f0f0
    style DB fill:#fff4e1
    style AuthSvc fill:#f3e5f5
    style Redis fill:#ffe0e0
    style AuthZ fill:#e8f5e9
    style FGA_DB fill:#c8e6c9</pre><p><strong>Architecture Notes:</strong></p><ul><li><strong>Authentication Layer</strong>:<ul><li>GitHub OAuth validates user identity during initial login</li><li>Auth Service generates JWT tokens signed with RS256 private key</li><li>JWKS endpoint (<code>/.well-known/jwks.json</code>) publishes public keys for token validation</li><li>Battle Bots app validates JWT signatures locally using cached public keys (no per-request service call)</li></ul></li><li><strong>Authorization Layer</strong>: OpenFGA Service handles fine-grained permissions checks for all protected operations</li><li><strong>Stateless Design</strong>: JWT tokens eliminate session storage; Redis is optional for token revocation blacklist</li><li><strong>Separation of Concerns</strong>:<ul><li>Authentication database stores user accounts and refresh tokens</li><li>Authorization database (OpenFGA) stores relationships and permissions</li><li>Token generation and token validation are decoupled via JWKS standard</li></ul></li></ul><p><strong>REST API Endpoints:</strong></p><table><thead><tr><th>Method</th><th>Endpoint</th><th>Auth Required</th><th>Purpose</th></tr></thead><tbody><tr><td><code>GET</code></td><td><code>/auth/github/login</code></td><td>No</td><td>Initiates GitHub OAuth flow with PKCE by generating code_challenge and CSRF state token, redirecting to GitHub authorization page</td></tr><tr><td><code>GET</code></td><td><code>/auth/github/callback</code></td><td>No</td><td>Handles OAuth callback from GitHub, exchanges auth code for GitHub access token, fetches user profile, creates/updates account, <strong>generates internal JWT access token + refresh token</strong>, sets httpOnly cookies</td></tr><tr><td><code>POST</code></td><td><code>/auth/terms/accept</code></td><td>JWT (Cookie)</td><td>Accepts terms of service for new user accounts (called before account creation)</td></tr><tr><td><code>POST</code></td><td><code>/auth/refresh</code></td><td>Refresh Token (Cookie)</td><td>Exchanges valid refresh token for new JWT access token + new refresh token (rotation), updates httpOnly cookies</td></tr><tr><td><code>GET</code></td><td><code>/auth/session</code></td><td>JWT (Cookie)</td><td>Returns current authenticated user information from JWT claims (no database lookup)</td></tr><tr><td><code>POST</code></td><td><code>/auth/logout</code></td><td>JWT (Cookie)</td><td>Revokes refresh token in database, optionally blacklists JWT, clears authentication cookies</td></tr><tr><td><code>GET</code></td><td><code>/.well-known/jwks.json</code></td><td>No</td><td>Returns JSON Web Key Set (JWKS) containing public keys for JWT signature validation. Used by Battle Bots app to validate tokens locally.</td></tr></tbody></table><p><strong>Protected Resource Endpoints (with OpenFGA Authorization):</strong></p><p>Protected endpoints follow a two-step security model: JWT authentication validates identity, then OpenFGA authorization checks permissions.</p><table><thead><tr><th>Method</th><th>Endpoint</th><th>Authentication</th><th>Authorization Check</th><th>Purpose</th></tr></thead><tbody><tr><td><code>POST</code></td><td><code>/bots/:id/deploy</code></td><td>JWT (Cookie)</td><td>OpenFGA: <code>user:github|username</code> has <code>can_deploy</code> on <code>bot:id</code></td><td>Deploy bot to game server</td></tr><tr><td><code>PUT</code></td><td><code>/bots/:id</code></td><td>JWT (Cookie)</td><td>OpenFGA: <code>user:github|username</code> has <code>can_edit</code> on <code>bot:id</code></td><td>Update bot configuration</td></tr><tr><td><code>DELETE</code></td><td><code>/bots/:id</code></td><td>JWT (Cookie)</td><td>OpenFGA: <code>user:github|username</code> has <code>can_delete</code> on <code>bot:id</code></td><td>Delete bot</td></tr><tr><td><code>POST</code></td><td><code>/teams/:id/members</code></td><td>JWT (Cookie)</td><td>OpenFGA: <code>user:github|username</code> has <code>can_manage_members</code> on <code>team:id</code></td><td>Add member to team</td></tr><tr><td><code>POST</code></td><td><code>/organizations/:id/teams</code></td><td>JWT (Cookie)</td><td>OpenFGA: <code>user:github|username</code> has <code>can_create_teams</code> on <code>organization:id</code></td><td>Create team in organization</td></tr></tbody></table><p><strong>Authorization Flow Pattern:</strong></p><ol><li>Middleware validates JWT and extracts user identity (e.g., <code>github|username</code>)</li><li>Middleware maps HTTP method + route to OpenFGA relation (e.g., <code>POST /bots/:id/deploy</code> → <code>can_deploy</code>)</li><li>Middleware calls OpenFGA Check API: <code>check(user, relation, object)</code></li><li>If OpenFGA returns <code>allowed: true</code>, request proceeds to handler</li><li>If OpenFGA returns <code>allowed: false</code>, return <code>403 Forbidden</code></li></ol><p><strong>Sequence Diagram - Registration/Login Flow:</strong></p><pre class=mermaid>sequenceDiagram
    actor User
    participant WebApp as Battle Bots Web App
    participant GitHub as GitHub OAuth
    participant DB as Database
    participant AuthSvc as Auth Service

    User-&gt;&gt;WebApp: GET /auth/github/login
    WebApp-&gt;&gt;WebApp: Generate code_verifier &#43; code_challenge (PKCE)
    WebApp-&gt;&gt;WebApp: Generate CSRF state token
    WebApp-&gt;&gt;User: 302 Redirect to GitHub OAuth (with code_challenge)
    User-&gt;&gt;GitHub: Authorize Battle Bots application

    alt Authorization Successful
        GitHub-&gt;&gt;WebApp: GET /auth/github/callback?code=xxx&amp;state=yyy
        WebApp-&gt;&gt;WebApp: Validate state token (CSRF protection)
        WebApp-&gt;&gt;GitHub: POST /login/oauth/access_token&lt;br/&gt;(exchange code &#43; code_verifier)
        GitHub--&gt;&gt;WebApp: Return GitHub access token
        WebApp-&gt;&gt;GitHub: GET /user (fetch profile)
        GitHub--&gt;&gt;WebApp: Return user data (ID, username, email)

        alt User Exists
            WebApp-&gt;&gt;DB: Update user profile
            DB--&gt;&gt;WebApp: Profile updated
        else New User
            WebApp-&gt;&gt;User: Show Terms of Service page
            User-&gt;&gt;WebApp: POST /auth/terms/accept (with JWT cookie)
            WebApp-&gt;&gt;DB: Create user account
            DB--&gt;&gt;WebApp: Account created
        end

        WebApp-&gt;&gt;AuthSvc: Generate JWT access token (RS256, 15min expiry)
        AuthSvc--&gt;&gt;WebApp: Signed JWT with claims (sub, iss, aud, exp, github_id, ...)
        Note over AuthSvc: Public keys available at&lt;br/&gt;/.well-known/jwks.json
        WebApp-&gt;&gt;WebApp: Generate refresh token (random 32-byte)
        WebApp-&gt;&gt;DB: Store refresh token hash (user_id, token_hash, expires_at)
        DB--&gt;&gt;WebApp: Token stored
        WebApp-&gt;&gt;User: 302 Redirect to dashboard&lt;br/&gt;(Set httpOnly cookies: access_token, refresh_token, csrf_token)

    else Authorization Failed/Cancelled
        GitHub-&gt;&gt;WebApp: GET /auth/github/callback?error=xxx
        WebApp-&gt;&gt;User: Show error message
    end</pre><p><strong>Sequence Diagram - Protected Operation with OpenFGA Authorization:</strong></p><pre class=mermaid>sequenceDiagram
    actor User
    participant WebApp as Battle Bots Web App
    participant AuthMiddleware as Auth Middleware
    participant AuthZMiddleware as AuthZ Middleware
    participant OpenFGA as OpenFGA Service
    participant Handler as Request Handler
    participant DB as Database

    Note over User,DB: User already authenticated with JWT cookie

    User-&gt;&gt;WebApp: POST /bots/battle-bot-1/deploy&lt;br/&gt;(JWT in httpOnly cookie)
    WebApp-&gt;&gt;AuthMiddleware: Validate authentication
    AuthMiddleware-&gt;&gt;AuthMiddleware: Verify JWT signature using cached public key&lt;br/&gt;(from /.well-known/jwks.json)
    Note over AuthMiddleware: Public keys cached locally,&lt;br/&gt;refreshed periodically or on validation failure

    alt JWT Invalid or Expired
        AuthMiddleware--&gt;&gt;WebApp: 401 Unauthorized
        WebApp-&gt;&gt;User: Redirect to login or show error
    else JWT Valid
        AuthMiddleware-&gt;&gt;AuthMiddleware: Extract user claims from JWT
        AuthMiddleware-&gt;&gt;AuthZMiddleware: user_id: github|alice, operation: deploy, resource: bot:battle-bot-1
        AuthZMiddleware-&gt;&gt;OpenFGA: Check(user: &#34;user:github|alice&#34;,&lt;br/&gt;relation: &#34;can_deploy&#34;,&lt;br/&gt;object: &#34;bot:battle-bot-1&#34;)
        OpenFGA-&gt;&gt;OpenFGA: Evaluate authorization model&lt;br/&gt;(check relationships and rules)

        alt User Not Authorized
            OpenFGA--&gt;&gt;AuthZMiddleware: allowed: false
            AuthZMiddleware--&gt;&gt;WebApp: 403 Forbidden
            WebApp-&gt;&gt;User: Show &#34;You don&#39;t have permission&#34; error
        else User Authorized
            OpenFGA--&gt;&gt;AuthZMiddleware: allowed: true
            AuthZMiddleware-&gt;&gt;Handler: Forward request
            Handler-&gt;&gt;DB: Execute deployment logic
            DB--&gt;&gt;Handler: Deployment successful
            Handler--&gt;&gt;WebApp: 200 OK {deployment_status}
            WebApp-&gt;&gt;User: Show success message
        end
    end</pre><p><strong>Authorization Decision Flow:</strong></p><p>The authorization middleware performs the following steps for every protected endpoint:</p><ol><li><strong>Extract User Identity</strong>: Get user ID from validated JWT claims (e.g., <code>github|alice</code>)</li><li><strong>Map Operation to Relation</strong>: Translate HTTP method + endpoint to OpenFGA relation<ul><li><code>POST /bots/:id/deploy</code> → <code>can_deploy</code></li><li><code>PUT /bots/:id</code> → <code>can_edit</code></li><li><code>DELETE /bots/:id</code> → <code>can_delete</code></li></ul></li><li><strong>Construct OpenFGA Check</strong>: Build check request with user, relation, and object</li><li><strong>Evaluate Permission</strong>: OpenFGA traverses relationship graph based on authorization model</li><li><strong>Enforce Decision</strong>: Allow (200/201) or deny (403) based on OpenFGA response</li></ol><p><strong>OpenFGA Authorization Model (Starter):</strong></p><p>This is the initial authorization model for Battle Bots MVP. It defines the organizational hierarchy and permission inheritance patterns.</p><pre tabindex=0><code>model
  schema 1.1

type user

type organization
  relations
    define owner: [user]
    define member: [user]
    define can_create_teams: owner or member
    define can_invite_members: owner

type team
  relations
    define parent_org: [organization]
    define admin: [user]
    define member: [user] or admin or owner from parent_org
    define can_manage_bots: admin or owner from parent_org
    define can_manage_members: admin or owner from parent_org

type bot
  relations
    define parent_team: [team]
    define creator: [user]
    define can_view: member from parent_team
    define can_edit: creator or can_manage_bots from parent_team
    define can_deploy: creator or can_manage_bots from parent_team
    define can_delete: creator or admin from parent_team

type game
  relations
    define participant_bot: [bot]
    define creator: [user]
    define can_view: creator or can_view from participant_bot
    define can_cancel: creator
</code></pre><p><strong>Model Explanation:</strong></p><ul><li><strong>Organizations</strong>: Top-level entities with owners and members. Owners can invite members; both can create teams.</li><li><strong>Teams</strong>: Belong to organizations. Organization owners automatically have admin rights on all teams in their org. Team admins can manage bots and members.</li><li><strong>Bots</strong>: Belong to teams. Bot creators can edit/deploy/delete their bots. Team admins can also manage all bots in their team. All team members can view bots.</li><li><strong>Games</strong>: Include participating bots. Game creator and anyone who can view participating bots can view the game.</li></ul><p><strong>Permission Inheritance Examples:</strong></p><ul><li>Alice is owner of Org A → Alice is automatically admin of Team X (part of Org A) → Alice can manage all bots in Team X</li><li>Bob is creator of Bot Y in Team X → Bob can edit, deploy, and delete Bot Y</li><li>Carol is member of Team X → Carol can view all bots in Team X, but cannot edit/deploy them</li></ul><p><strong>Relationship Tuple Examples:</strong></p><pre tabindex=0><code># Organization membership
user:github|alice, owner, organization:acme-corp
user:github|bob, member, organization:acme-corp

# Team structure
organization:acme-corp, parent_org, team:alpha-team
user:github|carol, admin, team:alpha-team

# Bot ownership
team:alpha-team, parent_team, bot:battle-bot-1
user:github|bob, creator, bot:battle-bot-1

# Game participation
bot:battle-bot-1, participant_bot, game:match-123
user:github|alice, creator, game:match-123
</code></pre><p>For complete OpenFGA deployment and configuration details, see <a href=/r&amp;d/analysis/open-source-applications/openfga-analysis/>OpenFGA Analysis</a>.</p><p><strong>JWKS (JSON Web Key Set) Implementation Details:</strong></p><p>The JWKS endpoint provides a standard mechanism for Battle Bots app to validate JWT tokens without coupling to the token generation service.</p><p><strong>JWKS Endpoint Format:</strong></p><p>The Auth Service exposes public keys at <code>/.well-known/jwks.json</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;keys&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&#34;kty&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;RSA&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&#34;kid&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;2024-11-primary&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&#34;use&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;sig&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&#34;alg&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;RS256&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&#34;n&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;0vx7agoebGcQSuuPiLJXZptN9nndrQmbXEps2aiAFbWhM78LhWx...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&#34;e&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;AQAB&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&#34;kty&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;RSA&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&#34;kid&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;2024-10-rotated&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&#34;use&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;sig&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&#34;alg&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;RS256&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&#34;n&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;xjlKJN9C5xW7JVZkGwmZZN3NnPQmbXEps2aiAFbWhM78LhWx...&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>      <span style=color:#204a87;font-weight:700>&#34;e&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;AQAB&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>  <span style=color:#000;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p><strong>Key Fields:</strong></p><ul><li><code>kty</code>: Key type (RSA for RS256 signatures)</li><li><code>kid</code>: Key ID used in JWT header to identify which key signed the token</li><li><code>use</code>: Key usage (<code>sig</code> for signature verification)</li><li><code>alg</code>: Algorithm (RS256 = RSA signature with SHA-256)</li><li><code>n</code>: RSA modulus (base64url-encoded)</li><li><code>e</code>: RSA exponent (typically AQAB = 65537)</li></ul><p><strong>Key Rotation Strategy:</strong></p><ol><li><strong>New Key Generation</strong>: Auth Service generates new RSA key pair monthly</li><li><strong>Dual Key Period</strong>: Both old and new public keys published in JWKS for 30 days</li><li><strong>Grace Period</strong>: Old key remains in JWKS while tokens signed with it are still valid (15min access token + 7 day refresh token = keep old key for 8 days minimum)</li><li><strong>Key Removal</strong>: Old key removed from JWKS after grace period expires</li></ol><p><strong>Client-Side Caching (Battle Bots App):</strong></p><pre tabindex=0><code>1. On startup: Fetch JWKS from /.well-known/jwks.json
2. Cache keys in memory with 1-hour TTL
3. When validating JWT:
   - Extract &#39;kid&#39; from JWT header
   - Look up public key in cache by &#39;kid&#39;
   - Verify signature using cached key
4. On signature validation failure:
   - Refresh JWKS from endpoint (handle key rotation)
   - Retry validation with updated keys
   - Return 401 if still invalid
5. Periodic refresh: Re-fetch JWKS every hour to stay current
</code></pre><p><strong>Security Considerations:</strong></p><ul><li>Public keys are safe to cache and distribute (cannot sign tokens, only verify)</li><li>Always validate JWT signature before trusting claims</li><li>Respect <code>kid</code> header to select correct key (prevents downgrade attacks)</li><li>JWKS endpoint should be served over HTTPS only</li><li>Rate limit JWKS endpoint to prevent abuse (recommended: 100 req/min per IP)</li></ul><h3 id=emailpassword-registration-with-jwt>Email/password registration with JWT</h3><p>Traditional registration with email/password and JWT tokens.</p><ul><li>Good, because no dependency on external OAuth providers</li><li>Good, because works for users without third-party accounts</li><li>Good, because full control over authentication flow</li><li>Bad, because requires implementing password reset, email verification</li><li>Bad, because need to securely store and hash passwords</li><li>Bad, because higher implementation and maintenance complexity</li><li>Bad, because more friction in registration process</li><li>Bad, because security burden of password management</li></ul><h4 id=implementation-visualization-1>Implementation Visualization</h4><p><strong>Architecture Diagram:</strong></p><pre class=mermaid>graph LR
    User[User Browser] --&gt; WebApp[Battle Bots Web App]
    WebApp --&gt; AuthService[Auth Service]
    AuthService --&gt; DB[(Database)]
    AuthService --&gt; JWT[JWT Token Service]
    AuthService --&gt; Email[Email Service]
    Email --&gt; SMTP[SMTP Server]

    style WebApp fill:#e1f5ff
    style AuthService fill:#e8f5e9
    style DB fill:#fff4e1
    style JWT fill:#f3e5f5
    style Email fill:#fff3e0
    style SMTP fill:#f0f0f0</pre><p><strong>REST API Endpoints:</strong></p><p><em>Authentication Endpoints:</em></p><table><thead><tr><th>Method</th><th>Endpoint</th><th>Auth Required</th><th>Purpose</th></tr></thead><tbody><tr><td><code>POST</code></td><td><code>/auth/register</code></td><td>No</td><td>Register new user account with email, password, and username. Sends verification email.</td></tr><tr><td><code>POST</code></td><td><code>/auth/login</code></td><td>No</td><td>Authenticate with email/password credentials. Returns JWT access token (15min) and refresh token (7 day).</td></tr><tr><td><code>POST</code></td><td><code>/auth/logout</code></td><td>JWT</td><td>Invalidates refresh token and terminates user session.</td></tr><tr><td><code>POST</code></td><td><code>/auth/refresh</code></td><td>Refresh Token</td><td>Exchanges valid refresh token for new access token.</td></tr></tbody></table><p><em>Email Verification Endpoints:</em></p><table><thead><tr><th>Method</th><th>Endpoint</th><th>Auth Required</th><th>Purpose</th></tr></thead><tbody><tr><td><code>GET</code></td><td><code>/auth/verify-email</code></td><td>No</td><td>Verifies email address using token from verification email (query param: <code>token</code>).</td></tr><tr><td><code>POST</code></td><td><code>/auth/resend-verification</code></td><td>No</td><td>Resends verification email to user&rsquo;s registered email address.</td></tr></tbody></table><p><em>Password Management Endpoints:</em></p><table><thead><tr><th>Method</th><th>Endpoint</th><th>Auth Required</th><th>Purpose</th></tr></thead><tbody><tr><td><code>POST</code></td><td><code>/auth/forgot-password</code></td><td>No</td><td>Requests password reset. Sends reset email if account exists (always returns success to prevent enumeration).</td></tr><tr><td><code>POST</code></td><td><code>/auth/reset-password</code></td><td>No</td><td>Resets password using token from reset email. Requires <code>token</code> and <code>new_password</code> in request body.</td></tr><tr><td><code>POST</code></td><td><code>/auth/change-password</code></td><td>JWT</td><td>Changes password for authenticated user. Requires <code>current_password</code> and <code>new_password</code>.</td></tr></tbody></table><p><strong>Sequence Diagram - Registration Flow:</strong></p><pre class=mermaid>sequenceDiagram
    actor User
    participant WebApp as Battle Bots Web App
    participant Auth as Auth Service
    participant DB as Database
    participant Email as Email Service

    User-&gt;&gt;WebApp: POST /auth/register&lt;br/&gt;{email, password, username}
    WebApp-&gt;&gt;Auth: Validate input (email format, password strength)

    alt Validation Failed
        Auth--&gt;&gt;WebApp: 400 Bad Request {errors}
        WebApp-&gt;&gt;User: Show validation error messages
    else Validation Passed
        Auth-&gt;&gt;DB: Check if email exists
        DB--&gt;&gt;Auth: Email availability

        alt Email Already Exists
            Auth--&gt;&gt;WebApp: 409 Conflict
            WebApp-&gt;&gt;User: Show &#34;Email already registered&#34; error
        else Email Available
            Auth-&gt;&gt;Auth: Hash password (bcrypt/argon2)
            Auth-&gt;&gt;DB: Create user account (unverified)
            DB--&gt;&gt;Auth: Account created
            Auth-&gt;&gt;Auth: Generate email verification token
            Auth-&gt;&gt;DB: Store verification token (with expiry)
            Auth-&gt;&gt;Email: Send verification email with link:&lt;br/&gt;GET /auth/verify-email?token=xxx
            Email--&gt;&gt;User: Verification email delivered
            Auth--&gt;&gt;WebApp: 201 Created
            WebApp-&gt;&gt;User: Show &#34;Check your email&#34; message
        end
    end

    Note over User,Email: User clicks verification link in email
    User-&gt;&gt;WebApp: GET /auth/verify-email?token=xxx
    WebApp-&gt;&gt;Auth: Validate verification token
    Auth-&gt;&gt;DB: Mark email as verified
    WebApp-&gt;&gt;User: 200 OK - Email verified, redirect to login</pre><p><strong>Sequence Diagram - Login Flow:</strong></p><pre class=mermaid>sequenceDiagram
    actor User
    participant WebApp as Battle Bots Web App
    participant Auth as Auth Service
    participant DB as Database
    participant JWT as JWT Service

    User-&gt;&gt;WebApp: POST /auth/login&lt;br/&gt;{email, password}
    WebApp-&gt;&gt;Auth: Authenticate credentials
    Auth-&gt;&gt;DB: Fetch user by email
    DB--&gt;&gt;Auth: User record

    alt User Not Found
        Auth--&gt;&gt;WebApp: 401 Unauthorized
        WebApp-&gt;&gt;User: Show &#34;Invalid credentials&#34; error
    else User Found
        Auth-&gt;&gt;Auth: Verify password hash (bcrypt/argon2)

        alt Password Invalid
            Auth--&gt;&gt;WebApp: 401 Unauthorized
            WebApp-&gt;&gt;User: Show &#34;Invalid credentials&#34; error
        else Password Valid
            alt Email Not Verified
                Auth--&gt;&gt;WebApp: 403 Forbidden {reason: &#34;email_not_verified&#34;}
                WebApp-&gt;&gt;User: Show verification reminder &#43;&lt;br/&gt;option to POST /auth/resend-verification
            else Email Verified
                Auth-&gt;&gt;JWT: Generate access token (15min expiry)
                JWT--&gt;&gt;Auth: Access token (JWT)
                Auth-&gt;&gt;JWT: Generate refresh token (7 day expiry)
                JWT--&gt;&gt;Auth: Refresh token
                Auth-&gt;&gt;DB: Store refresh token hash
                Auth--&gt;&gt;WebApp: 200 OK {access_token, refresh_token, expires_in}
                WebApp-&gt;&gt;User: Store tokens, redirect to dashboard
            end
        end
    end</pre><p><strong>Sequence Diagram - Password Reset Flow:</strong></p><pre class=mermaid>sequenceDiagram
    actor User
    participant WebApp as Battle Bots Web App
    participant Auth as Auth Service
    participant DB as Database
    participant Email as Email Service

    Note over User,Email: Request Password Reset
    User-&gt;&gt;WebApp: Click &#34;Forgot Password&#34; link
    User-&gt;&gt;WebApp: POST /auth/forgot-password&lt;br/&gt;{email}
    WebApp-&gt;&gt;Auth: Request password reset
    Auth-&gt;&gt;DB: Check if email exists

    Note over Auth,Email: Always return success (prevent email enumeration)
    Auth--&gt;&gt;WebApp: 200 OK {message: &#34;If account exists, email sent&#34;}
    WebApp-&gt;&gt;User: Show &#34;Check your email&#34; message

    opt Email Exists
        Auth-&gt;&gt;Auth: Generate reset token (1 hour expiry)
        Auth-&gt;&gt;DB: Store reset token hash
        Auth-&gt;&gt;Email: Send reset email with link:&lt;br/&gt;GET /auth/reset-password?token=xxx
        Email--&gt;&gt;User: Reset email delivered
    end

    Note over User,DB: Reset Password
    User-&gt;&gt;WebApp: GET /auth/reset-password?token=xxx&lt;br/&gt;(click link in email)
    WebApp-&gt;&gt;Auth: Validate reset token
    Auth-&gt;&gt;DB: Check token validity &amp; expiry

    alt Token Invalid/Expired
        Auth--&gt;&gt;WebApp: 400 Bad Request {error: &#34;invalid_token&#34;}
        WebApp-&gt;&gt;User: Show error, offer POST /auth/forgot-password
    else Token Valid
        Auth--&gt;&gt;WebApp: 200 OK
        WebApp-&gt;&gt;User: Show new password form
        User-&gt;&gt;WebApp: POST /auth/reset-password&lt;br/&gt;{token, new_password}
        WebApp-&gt;&gt;Auth: Update password
        Auth-&gt;&gt;Auth: Hash new password (bcrypt/argon2)
        Auth-&gt;&gt;DB: Update password hash
        Auth-&gt;&gt;DB: Invalidate reset token
        Auth-&gt;&gt;Email: Send password changed notification email
        Auth--&gt;&gt;WebApp: 200 OK
        WebApp-&gt;&gt;User: Show success, redirect to POST /auth/login
    end</pre><h3 id=google-oauth-authentication>Google OAuth authentication</h3><p>Single OAuth provider (Google) for registration and authentication.</p><ul><li>Good, because most users have Google accounts</li><li>Good, because no password management needed</li><li>Good, because Google OAuth is reliable and well-documented</li><li>Neutral, because less aligned with developer-focused audience than GitHub</li><li>Bad, because vendor dependency on Google</li><li>Bad, because no fallback if Google OAuth is unavailable</li></ul><h4 id=implementation-visualization-2>Implementation Visualization</h4><p><strong>Architecture Diagram:</strong></p><pre class=mermaid>graph LR
    User[User Browser] --&gt; WebApp[Battle Bots Web App]
    WebApp --&gt; Google[Google OAuth]
    WebApp --&gt; DB[(Database)]
    WebApp --&gt; Session[Session Store]
    Google --&gt; User

    style WebApp fill:#e1f5ff
    style Google fill:#f0f0f0
    style DB fill:#fff4e1
    style Session fill:#fff4e1</pre><p><strong>REST API Endpoints:</strong></p><table><thead><tr><th>Method</th><th>Endpoint</th><th>Auth Required</th><th>Purpose</th></tr></thead><tbody><tr><td><code>GET</code></td><td><code>/auth/google/login</code></td><td>No</td><td>Initiates Google OAuth flow by generating CSRF state token and redirecting to Google authorization page</td></tr><tr><td><code>GET</code></td><td><code>/auth/google/callback</code></td><td>No</td><td>Handles OAuth callback from Google, exchanges auth code for access token, validates ID token, fetches user profile, creates/updates account</td></tr><tr><td><code>POST</code></td><td><code>/auth/terms/accept</code></td><td>Session</td><td>Accepts terms of service for new user accounts (called before account creation)</td></tr><tr><td><code>GET</code></td><td><code>/auth/session</code></td><td>Session</td><td>Returns current authenticated user information and session status</td></tr><tr><td><code>POST</code></td><td><code>/auth/logout</code></td><td>Session</td><td>Terminates user session and clears authentication cookies/tokens</td></tr></tbody></table><p><strong>Sequence Diagram - Registration/Login Flow:</strong></p><pre class=mermaid>sequenceDiagram
    actor User
    participant WebApp as Battle Bots Web App
    participant Google as Google OAuth
    participant DB as Database
    participant Session as Session Store

    User-&gt;&gt;WebApp: GET /auth/google/login
    WebApp-&gt;&gt;WebApp: Generate CSRF state token
    WebApp-&gt;&gt;User: 302 Redirect to Google OAuth
    User-&gt;&gt;Google: Authorize Battle Bots application

    alt Authorization Successful
        Google-&gt;&gt;WebApp: GET /auth/google/callback?code=xxx&amp;state=yyy
        WebApp-&gt;&gt;WebApp: Validate state token
        WebApp-&gt;&gt;Google: POST /token (exchange code)
        Google--&gt;&gt;WebApp: Return access_token &amp; id_token (JWT)
        WebApp-&gt;&gt;WebApp: Validate ID token (JWT signature &#43; claims)
        WebApp-&gt;&gt;Google: GET /oauth2/v2/userinfo (optional)
        Google--&gt;&gt;WebApp: Return user data (sub, email, name, picture)

        alt User Exists
            WebApp-&gt;&gt;DB: Update user profile
            DB--&gt;&gt;WebApp: Profile updated
        else New User
            WebApp-&gt;&gt;User: Show Terms of Service page
            User-&gt;&gt;WebApp: POST /auth/terms/accept
            WebApp-&gt;&gt;DB: Create user account
            DB--&gt;&gt;WebApp: Account created
        end

        WebApp-&gt;&gt;Session: Create authenticated session
        Session--&gt;&gt;WebApp: Session token
        WebApp-&gt;&gt;User: 302 Redirect to dashboard (with session cookie)

    else Authorization Failed/Cancelled
        Google-&gt;&gt;WebApp: GET /auth/google/callback?error=xxx
        WebApp-&gt;&gt;User: Show error message
    end</pre><h3 id=support-multiple-oauth-providers-github-google-gitlab>Support multiple OAuth providers (GitHub, Google, GitLab)</h3><p>Allow users to choose from multiple OAuth providers.</p><ul><li>Good, because provides user choice and flexibility</li><li>Good, because reduces single vendor dependency</li><li>Good, because accommodates different user preferences</li><li>Bad, because significantly higher implementation complexity</li><li>Bad, because need to handle account linking/merging</li><li>Bad, because increases testing surface area</li><li>Bad, because delays time to launch</li><li>Bad, because more complex user experience (choice paralysis)</li></ul><h4 id=implementation-visualization-3>Implementation Visualization</h4><p><strong>Architecture Diagram:</strong></p><pre class=mermaid>graph TB
    User[User Browser] --&gt; WebApp[Battle Bots Web App]
    WebApp --&gt; OAuthGateway[OAuth Gateway/Strategy]
    OAuthGateway --&gt; GitHub[GitHub OAuth Provider]
    OAuthGateway --&gt; Google[Google OAuth Provider]
    OAuthGateway --&gt; GitLab[GitLab OAuth Provider]
    WebApp --&gt; DB[(Database)]
    WebApp --&gt; Session[Session Store]
    DB --&gt; UserAccounts[User Accounts Table]
    DB --&gt; LinkedProviders[Linked Providers Table]

    style WebApp fill:#e1f5ff
    style OAuthGateway fill:#e8f5e9
    style GitHub fill:#f0f0f0
    style Google fill:#f0f0f0
    style GitLab fill:#f0f0f0
    style DB fill:#fff4e1
    style Session fill:#fff4e1
    style UserAccounts fill:#fff9c4
    style LinkedProviders fill:#fff9c4</pre><p><strong>REST API Endpoints:</strong></p><p><em>OAuth Authentication Endpoints (Provider-Agnostic):</em></p><table><thead><tr><th>Method</th><th>Endpoint</th><th>Auth Required</th><th>Purpose</th></tr></thead><tbody><tr><td><code>GET</code></td><td><code>/auth/:provider/login</code></td><td>No</td><td>Initiates OAuth flow for specified provider (<code>:provider</code> = <code>github</code>, <code>google</code>, or <code>gitlab</code>). Generates CSRF state and redirects.</td></tr><tr><td><code>GET</code></td><td><code>/auth/:provider/callback</code></td><td>No</td><td>Handles OAuth callback from specified provider. Exchanges code for token, fetches profile, handles account creation/linking logic.</td></tr><tr><td><code>POST</code></td><td><code>/auth/terms/accept</code></td><td>Session</td><td>Accepts terms of service for new user accounts (called before account creation).</td></tr><tr><td><code>GET</code></td><td><code>/auth/session</code></td><td>Session</td><td>Returns current authenticated user information, session status, and list of linked providers.</td></tr><tr><td><code>POST</code></td><td><code>/auth/logout</code></td><td>Session</td><td>Terminates user session and clears authentication cookies/tokens.</td></tr></tbody></table><p><em>Provider Management Endpoints:</em></p><table><thead><tr><th>Method</th><th>Endpoint</th><th>Auth Required</th><th>Purpose</th></tr></thead><tbody><tr><td><code>GET</code></td><td><code>/auth/providers</code></td><td>Session (optional)</td><td>Lists available OAuth providers. If authenticated, includes which providers are linked to current user&rsquo;s account.</td></tr><tr><td><code>POST</code></td><td><code>/auth/link/:provider</code></td><td>Session</td><td>Initiates OAuth flow to link an additional provider to the authenticated user&rsquo;s existing account.</td></tr><tr><td><code>DELETE</code></td><td><code>/auth/unlink/:provider</code></td><td>Session</td><td>Unlinks specified provider from authenticated user&rsquo;s account. Requires at least one provider to remain linked.</td></tr></tbody></table><p><strong>Sequence Diagram - Provider Selection and Registration:</strong></p><pre class=mermaid>sequenceDiagram
    actor User
    participant WebApp as Battle Bots Web App
    participant Gateway as OAuth Gateway
    participant Provider as Selected OAuth Provider
    participant DB as Database
    participant Session as Session Store

    User-&gt;&gt;WebApp: GET /login (view login page)
    WebApp-&gt;&gt;WebApp: GET /auth/providers (fetch available)
    WebApp-&gt;&gt;User: Show provider buttons (GitHub, Google, GitLab)
    User-&gt;&gt;WebApp: GET /auth/github/login (example: select GitHub)
    WebApp-&gt;&gt;Gateway: Initiate OAuth with GitHub
    Gateway-&gt;&gt;Gateway: Load provider-specific config &amp; strategy
    Gateway-&gt;&gt;WebApp: Generate CSRF state token
    WebApp-&gt;&gt;User: 302 Redirect to github.com/login/oauth/authorize
    User-&gt;&gt;Provider: Authorize Battle Bots application

    alt Authorization Successful
        Provider-&gt;&gt;Gateway: GET /auth/github/callback?code=xxx&amp;state=yyy
        Gateway-&gt;&gt;Gateway: Validate state token
        Gateway-&gt;&gt;Provider: Exchange code for access token
        Provider--&gt;&gt;Gateway: Return access token
        Gateway-&gt;&gt;Provider: Fetch user profile
        Provider--&gt;&gt;Gateway: Return user data (provider_id, email, name)
        Gateway-&gt;&gt;DB: Check if provider user ID exists

        alt Provider Account Already Linked
            DB--&gt;&gt;Gateway: Found existing account
            Gateway-&gt;&gt;DB: Update profile from provider
            Gateway-&gt;&gt;Session: Create authenticated session
            Session--&gt;&gt;Gateway: Session token
            Gateway-&gt;&gt;WebApp: 200 OK
            WebApp-&gt;&gt;User: 302 Redirect to dashboard
        else New Provider Account
            Gateway-&gt;&gt;DB: Check email across all providers
            DB--&gt;&gt;Gateway: Email lookup results

            alt Email Exists with Different Provider
                DB--&gt;&gt;Gateway: Found account with same email
                Gateway-&gt;&gt;WebApp: Show account linking confirmation UI
                WebApp-&gt;&gt;User: &#34;Link to existing account or create new?&#34;

                opt User Chooses to Link
                    User-&gt;&gt;WebApp: POST /auth/link/github {confirm: true}
                    WebApp-&gt;&gt;Gateway: Link provider to existing account
                    Gateway-&gt;&gt;DB: INSERT INTO linked_providers
                    Gateway-&gt;&gt;Session: Create authenticated session
                    WebApp-&gt;&gt;User: 302 Redirect to dashboard
                end

                opt User Chooses New Account
                    User-&gt;&gt;WebApp: Create separate account
                    WebApp-&gt;&gt;User: Show Terms of Service page
                    User-&gt;&gt;WebApp: POST /auth/terms/accept
                    Gateway-&gt;&gt;DB: INSERT INTO users (new account)
                    Gateway-&gt;&gt;Session: Create authenticated session
                    WebApp-&gt;&gt;User: 302 Redirect to onboarding
                end

            else Email Not Found
                WebApp-&gt;&gt;User: Show Terms of Service page
                User-&gt;&gt;WebApp: POST /auth/terms/accept
                Gateway-&gt;&gt;DB: INSERT INTO users &#43; linked_providers
                Gateway-&gt;&gt;Session: Create authenticated session
                WebApp-&gt;&gt;User: 302 Redirect to onboarding
            end
        end

    else Authorization Failed/Cancelled
        Provider-&gt;&gt;Gateway: GET /auth/github/callback?error=access_denied
        Gateway-&gt;&gt;WebApp: OAuth failed
        WebApp-&gt;&gt;User: Show error, return to GET /login
    end</pre><p><strong>Sequence Diagram - Account Linking (Authenticated User):</strong></p><pre class=mermaid>sequenceDiagram
    actor User
    participant WebApp as Battle Bots Web App
    participant Gateway as OAuth Gateway
    participant NewProvider as New OAuth Provider
    participant DB as Database

    Note over User,DB: User already authenticated, wants to link additional provider

    User-&gt;&gt;WebApp: GET /account/settings
    WebApp-&gt;&gt;WebApp: GET /auth/providers (with auth token)
    WebApp-&gt;&gt;User: Show linked providers &#43; &#34;Link GitHub&#34; button
    User-&gt;&gt;WebApp: POST /auth/link/github (click &#34;Link GitHub&#34;)
    WebApp-&gt;&gt;Gateway: Initiate OAuth for linking
    Gateway-&gt;&gt;Gateway: Generate state token with user_id embedded
    Gateway-&gt;&gt;User: 302 Redirect to github.com/login/oauth/authorize
    User-&gt;&gt;NewProvider: Authorize Battle Bots application

    alt Authorization Successful
        NewProvider-&gt;&gt;Gateway: GET /auth/github/callback?code=xxx&amp;state=yyy
        Gateway-&gt;&gt;Gateway: Validate state &amp; extract user_id from state
        Gateway-&gt;&gt;NewProvider: POST /login/oauth/access_token (exchange code)
        NewProvider--&gt;&gt;Gateway: Return access token
        Gateway-&gt;&gt;NewProvider: GET /user (fetch profile)
        NewProvider--&gt;&gt;Gateway: Return provider user data (github_id, email)
        Gateway-&gt;&gt;DB: SELECT * FROM linked_providers&lt;br/&gt;WHERE provider=&#39;github&#39;&lt;br/&gt;AND provider_user_id=github_id

        alt Provider Account Already Linked to Different User
            DB--&gt;&gt;Gateway: Conflict - belongs to user_id=999
            Gateway-&gt;&gt;WebApp: 409 Conflict {error: &#34;provider_already_linked&#34;}
            WebApp-&gt;&gt;User: Show &#34;This GitHub account is already linked&lt;br/&gt;to a different Battle Bots account&#34;
        else Provider Account Available
            Gateway-&gt;&gt;DB: INSERT INTO linked_providers&lt;br/&gt;(user_id, provider, provider_user_id)
            DB--&gt;&gt;Gateway: Link created successfully
            Gateway-&gt;&gt;WebApp: 200 OK {linked_providers: [...]}
            WebApp-&gt;&gt;User: Show success &#43; refresh GET /auth/providers
        end

    else Authorization Failed/Cancelled
        NewProvider-&gt;&gt;Gateway: GET /auth/github/callback?error=access_denied
        Gateway-&gt;&gt;WebApp: 400 Bad Request {error: &#34;oauth_cancelled&#34;}
        WebApp-&gt;&gt;User: Show &#34;Linking cancelled&#34; message
    end</pre><p><strong>Key Implementation Considerations:</strong></p><ul><li><strong>Provider Strategy Pattern</strong>: Each OAuth provider (GitHub, Google, GitLab) has its own strategy implementing a common interface for authorization, token exchange, and profile fetching</li><li><strong>Account Linking Logic</strong>: Must handle cases where users authenticate with different providers but share the same email</li><li><strong>Data Model</strong>: Requires <code>linked_providers</code> table with columns: <code>user_id</code>, <code>provider</code>, <code>provider_user_id</code>, <code>provider_username</code>, <code>linked_at</code></li><li><strong>Testing Complexity</strong>: Need integration tests for each provider plus account linking scenarios</li><li><strong>User Experience</strong>: Clear messaging when email conflicts occur across providers</li></ul><h2 id=more-information>More Information</h2><p>Related to User Journey 0001 (User Registration and Authentication).</p><p>This decision focuses on the initial launch strategy. Future ADRs may address:</p><ul><li>Adding additional OAuth providers based on user feedback</li><li>Account migration strategies if switching providers</li><li>Service account or API key authentication for bot deployments</li></ul></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title="GitHub Discussions" aria-label="GitHub Discussions"><a target=_blank rel=noopener href=https://github.com/z5labs/battlebots/discussions aria-label="GitHub Discussions"><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/z5labs/battlebots aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2025
<span class=td-footer__authors>Z5Labs and Contributors</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span></div></div></div></footer></div><script type=module async>
  import mermaid from "https:\/\/cdn.jsdelivr.net\/npm\/mermaid@latest\/dist\/mermaid.esm.min.mjs";

  (function ($) {
    if ($('.mermaid').length == 0) {
      mermaid.initialize({ startOnLoad: false });
      return;
    }

    var params = {};

    
    
    var norm = function (defaultConfig, params) {
      var result = {};
      for (const key in defaultConfig) {
        const keyLower = key.toLowerCase();
        if (defaultConfig.hasOwnProperty(key) && params.hasOwnProperty(keyLower)) {
          if (typeof defaultConfig[key] === "object") {
            result[key] = norm(defaultConfig[key], params[keyLower]);
          } else {
            result[key] = params[keyLower];
          }
        }
      }
      return result;
    };

    var settings = norm(mermaid.mermaidAPI.defaultConfig, params);
    settings.startOnLoad = true;
    if ($('html[data-bs-theme="dark"]').length) {
      settings.theme = 'dark';
    }
    mermaid.initialize(settings);

    
    const lightDarkModeThemeChangeHandler = function (mutationsList, observer) {
      for (const mutation of mutationsList) {
        if (mutation.type === 'attributes' && mutation.attributeName === 'data-bs-theme') {
          
          
          
          location.reload();
        }
      }
    };

    const observer = new MutationObserver(lightDarkModeThemeChangeHandler);
    observer.observe(document.documentElement, {
      attributes: true,
      attributeFilter: ['data-bs-theme']
    });
    

  })(jQuery);
</script><script src=/battlebots/pr-preview/pr-139/js/main.min.403ff095218c662472dab60ed98ecbb19431682de5ac7c6159891241cd366af5.js integrity="sha256-QD/wlSGMZiRy2rYO2Y7LsZQxaC3lrHxhWYkSQc02avU=" crossorigin=anonymous></script><script defer src=/battlebots/pr-preview/pr-139/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/battlebots/pr-preview/pr-139/js/tabpane-persist.js></script></body></html>